<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.hyundai.mapper.OrderMapper">

	<insert id="insertItem">

		INSERT INTO orderitem(oid, pid, ccolorcode, ssize, oamount)
		VALUES(#{oid}, #{pid}, #{ccolorcode}, #{ssize}, #{oamount})

	</insert>

	<insert id="insertList">

		INSERT INTO orderlist(oid, mid, oaddress1, oaddress2, odate, oreceiver,
		otel, opayment, ostatus)
		VALUES(sq_orderlist.nextval, #{mid}, #{oaddress1}, #{oaddress2}, sysdate + (interval '9' hour), #{oreceiver}, #{otel},
		0, 0)

	</insert>

	<select id="getOid" resultType="String">

		SELECT oid FROM orderlist WHERE ROWNUM = 1 ORDER BY oid DESC

	</select>

	<select id="getOrder" resultType="com.hyundai.domain.OrderVO">
		SELECT ol.oid, p.pname, oi.oamount, p.pprice, ol.ostatus, ol.odate
		FROM product p, orderitem oi, orderlist ol
		WHERE ol.mid = #{mid, jdbcType=VARCHAR}
		AND p.pid = oi.pid
		AND oi.oid = ol.oid
		ORDER BY ol.oid DESC
	</select>

</mapper>